var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function i(t){t.forEach(e)}function r(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function o(t,e){t.appendChild(e)}function u(t,e,n){t.insertBefore(e,n||null)}function a(t){t.parentNode.removeChild(t)}function c(t){return document.createElement(t)}function l(t){return document.createTextNode(t)}function f(){return l(" ")}function d(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function p(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function m(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function g(t,e){t.value=null==e?"":e}let h;function v(t){h=t}const b=[],x=[],$=[],_=[],y=Promise.resolve();let I=!1;function A(t){$.push(t)}let E=!1;const q=new Set;function S(){if(!E){E=!0;do{for(let t=0;t<b.length;t+=1){const e=b[t];v(e),D(e.$$)}for(v(null),b.length=0;x.length;)x.pop()();for(let t=0;t<$.length;t+=1){const e=$[t];q.has(e)||(q.add(e),e())}$.length=0}while(b.length);for(;_.length;)_.pop()();I=!1,E=!1,q.clear()}}function D(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(A)}}const w=new Set;function j(t,e){-1===t.$$.dirty[0]&&(b.push(t),I||(I=!0,y.then(S)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function C(s,o,u,c,l,f,d=[-1]){const p=h;v(s);const m=s.$$={fragment:null,ctx:null,props:f,update:t,not_equal:l,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(p?p.$$.context:o.context||[]),callbacks:n(),dirty:d,skip_bound:!1};let g=!1;if(m.ctx=u?u(s,o.props||{},((t,e,...n)=>{const i=n.length?n[0]:e;return m.ctx&&l(m.ctx[t],m.ctx[t]=i)&&(!m.skip_bound&&m.bound[t]&&m.bound[t](i),g&&j(s,t)),e})):[],m.update(),g=!0,i(m.before_update),m.fragment=!!c&&c(m.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);m.fragment&&m.fragment.l(t),t.forEach(a)}else m.fragment&&m.fragment.c();o.intro&&((b=s.$$.fragment)&&b.i&&(w.delete(b),b.i(x))),function(t,n,s,o){const{fragment:u,on_mount:a,on_destroy:c,after_update:l}=t.$$;u&&u.m(n,s),o||A((()=>{const n=a.map(e).filter(r);c?c.push(...n):i(n),t.$$.on_mount=[]})),l.forEach(A)}(s,o.target,o.anchor,o.customElement),S()}var b,x;v(p)}var N=function(t,e){return e.length>1?e.indexOf(t.slice(-1))>-1:t.slice(-1)===e},M=function(t,e){return t.slice(t.length-e.length)===e};var O,T=(function(t,e){var n,i=["al","adj","assn","Ave","BSc","MSc","Cell","Ch","Co","cc","Corp","Dem","Dept","ed","eg","Eq","Eqs","est","est","etc","Ex","ext","Fig","fig","Figs","figs","i.e","ie","Inc","inc","Jan","Feb","Mar","Apr","Jun","Jul","Aug","Sep","Sept","Oct","Nov","Dec","jr","mi","Miss","Mrs","Mr","Ms","Mol","mt","mts","no","Nos","PhD","MD","BA","MA","MM","pl","pop","pp","Prof","Dr","pt","Ref","Refs","Rep","repr","rev","Sec","Secs","Sgt","Col","Gen","Rep","Sen","Gov","Lt","Maj","Capt","St","Sr","sr","Jr","jr","Rev","Sun","Mon","Tu","Tue","Tues","Wed","Th","Thu","Thur","Thurs","Fri","Sat","trans","Univ","Viz","Vol","vs","v"];e.setAbbreviations=function(t){n=t||i};var r=e.isCapitalized=function(t){return/^[A-Z][a-z].*/.test(t)||s(t)};e.isSentenceStarter=function(t){return r(t)||/``|"|'/.test(t.substring(0,2))},e.isCommonAbbreviation=function(t){var e=t.replace(/[-'`~!@#$%^&*()_|+=?;:'",.<>\{\}\[\]\\\/]/gi,"");return~n.indexOf(e)},e.isTimeAbbreviation=function(t,e){return("a.m."===t||"p.m."===t)&&"day"===e.replace(/\W+/g,"").slice(-3).toLowerCase()},e.isDottedAbbreviation=function(t){var e=t.replace(/[\(\)\[\]\{\}]/g,"").match(/(.\.)*/);return e&&e[0].length>0},e.isCustomAbbreviation=function(t){return t.length<=3||r(t)},e.isNameAbbreviation=function(t,e){return e.length>0&&(!!(t<5&&e[0].length<6&&r(e[0]))||e.filter((function(t){return/[A-Z]/.test(t.charAt(0))})).length>=3)};var s=e.isNumber=function(t,e){return e&&(t=t.slice(e-1,e+2)),!isNaN(t)};e.isPhoneNr=function(t){return t.match(/^(?:(?:\+?1\s*(?:[.-]\s*)?)?(?:\(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\s*\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\s*(?:[.-]\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[.-]\s*)?([0-9]{4})(?:\s*(?:#|x\.?|ext\.?|extension)\s*(\d+))?$/)},e.isURL=function(t){return t.match(/[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/)},e.isConcatenated=function(t){var e=0;return!(!((e=t.indexOf("."))>-1||(e=t.indexOf("!"))>-1||(e=t.indexOf("?"))>-1)||!t.charAt(e+1).match(/[a-zA-Z].*/))&&[t.slice(0,e),t.slice(e+1)]},e.isBoundaryChar=function(t){return"."===t||"!"===t||"?"===t}}(O={exports:{}},O.exports),O.exports),k=" @~@ ",z=k.trim(),L=new RegExp("\\S",""),R=new RegExp("\\n+|[-#=_+*]{4,}","g"),Z=new RegExp("\\S+|\\n","g"),F=function(t,e){if(!t||"string"!=typeof t||!t.length)return[];if(!L.test(t))return[];var n,i,r={newline_boundaries:!1,html_boundaries:!1,html_boundaries_tags:["p","div","ul","ol"],sanitize:!1,allowed_tags:!1,preserve_whitespace:!1,abbreviations:null};if("boolean"==typeof e)r.newline_boundaries=!0;else for(var s in e)r[s]=e[s];if(T.setAbbreviations(r.abbreviations),r.newline_boundaries&&(t=t.replace(R,k)),r.html_boundaries){var o="(<br\\s*\\/?>|<\\/("+r.html_boundaries_tags.join("|")+")>)",u=new RegExp(o,"g");t=t.replace(u,"$1 @~@ ")}(r.sanitize||r.allowed_tags)&&(r.allowed_tags||(r.allowed_tags=[""]),t=function(t,e){if(("string"==typeof t||t instanceof String)&&"undefined"!=typeof document){var n=document.createElement("DIV");n.innerHTML=t,t=(n.textContent||"").trim()}else"object"==typeof t&&t.textContent&&(t=(t.textContent||"").trim());return t}(t));var a=0,c=0,l=[],f=[],d=[];if(!(n=r.preserve_whitespace?(i=t.split(/(<br\s*\/?>|\S+|\n+)/)).filter((function(t,e){return e%2})):t.trim().match(Z))||!n.length)return[];for(var p=0,m=n.length;p<m;p++)if(a++,d.push(n[p]),~n[p].indexOf(",")&&(a=0),T.isBoundaryChar(n[p])||N(n[p],"?!")||n[p]===z)(r.newline_boundaries||r.html_boundaries)&&n[p]===z&&d.pop(),f.push(d),a=0,d=[];else if((N(n[p],'"')||N(n[p],"”"))&&(n[p]=n[p].slice(0,-1)),N(n[p],".")){if(p+1<m){if(2===n[p].length&&isNaN(n[p].charAt(0)))continue;if(T.isCommonAbbreviation(n[p]))continue;if(T.isSentenceStarter(n[p+1])){if(T.isTimeAbbreviation(n[p],n[p+1]))continue;if(T.isNameAbbreviation(a,n.slice(p,6)))continue;if(T.isNumber(n[p+1])&&T.isCustomAbbreviation(n[p]))continue}else{if(M(n[p],".."))continue;if(T.isDottedAbbreviation(n[p]))continue;if(T.isNameAbbreviation(a,n.slice(p,5)))continue}}f.push(d),d=[],a=0}else{if((c=n[p].indexOf("."))>-1){if(T.isNumber(n[p],c))continue;if(T.isDottedAbbreviation(n[p]))continue;if(T.isURL(n[p])||T.isPhoneNr(n[p]))continue}(l=T.isConcatenated(n[p]))&&(d.pop(),d.push(l[0]),f.push(d),a=0,(d=[]).push(l[1]))}return d.length&&f.push(d),(f=f.filter((function(t){return t.length>0}))).slice(1).reduce((function(t,e){var n=t[t.length-1];return 1===n.length&&/^.{1,2}[.]$/.test(n[0])&&!/[.]/.test(e[0])?(t.pop(),t.push(n.concat(e)),t):(t.push(e),t)}),[f[0]]).map((function(t,e){if(r.preserve_whitespace&&!r.newline_boundaries&&!r.html_boundaries){var n=2*t.length;return 0===e&&(n+=1),i.splice(0,n).join("")}return t.join(" ")}))};function B(t,e,n){const i=t.slice();return i[11]=e[n].source,i[12]=e[n].target,i[13]=e[n].id,i[14]=e[n].status,i[15]=e,i[16]=n,i}function P(t){let e,n,i,r,s,l,d,m,g,h,v=t[1],b=[];for(let e=0;e<v.length;e+=1)b[e]=U(B(t,v,e));return{c(){e=c("div"),n=c("div"),i=c("div"),r=f(),s=c("div"),l=f(),d=c("div");for(let t=0;t<b.length;t+=1)b[t].c();m=f(),g=c("div"),h=c("textarea"),p(i,"class","resize-bar svelte-1xmjlqq"),p(s,"class","resize-line svelte-1xmjlqq"),p(d,"class","pane-left-actual svelte-1xmjlqq"),p(n,"class","pane-left svelte-1xmjlqq"),p(h,"class","preview-textarea svelte-1xmjlqq"),h.value=t[2],p(g,"class","pane-right svelte-1xmjlqq"),p(e,"class","pane-container svelte-1xmjlqq")},m(t,a){u(t,e,a),o(e,n),o(n,i),o(n,r),o(n,s),o(n,l),o(n,d);for(let t=0;t<b.length;t+=1)b[t].m(d,null);o(e,m),o(e,g),o(g,h)},p(t,e){if(26&e){let n;for(v=t[1],n=0;n<v.length;n+=1){const i=B(t,v,n);b[n]?b[n].p(i,e):(b[n]=U(i),b[n].c(),b[n].m(d,null))}for(;n<b.length;n+=1)b[n].d(1);b.length=v.length}4&e&&(h.value=t[2])},d(t){t&&a(e),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(b,t)}}}function J(t){let e,n,i;return{c(){e=c("textarea"),p(e,"class","source-textarea svelte-1xmjlqq"),p(e,"placeholder","在此处粘贴要翻译的文本")},m(r,s){u(r,e,s),g(e,t[0]),n||(i=d(e,"input",t[5]),n=!0)},p(t,n){1&n&&g(e,t[0])},d(t){t&&a(e),n=!1,i()}}}function U(t){let e,n,r,s,h,v,b,x,$,_,y,I,A,E=t[11]+"",q=`<#Segment${t[13]}>`;function S(){t[6].call(x,t[15],t[16])}function D(){return t[7](t[14],t[15],t[16])}function w(){return t[8](t[12],t[11],t[15],t[16],t[14])}return{c(){e=c("p"),n=l(E),r=f(),s=c("span"),h=l(q),b=f(),x=c("textarea"),_=f(),y=c("button"),y.textContent="revert",p(s,"class",v="segment-tag\n\t\t\t\t "+(t[3].INITIALIZED===t[14]?"initialized":"")+"\n\t\t\t\t "+(t[3].MODIFIED===t[14]?"modified":"")+" svelte-1xmjlqq"),p(x,"data-segment-id",$=t[13]),p(x,"class","line-editor svelte-1xmjlqq")},m(i,a){u(i,e,a),o(e,n),o(e,r),o(e,s),o(s,h),u(i,b,a),u(i,x,a),g(x,t[12]),u(i,_,a),u(i,y,a),I||(A=[d(x,"input",S),d(x,"keyup",t[4]),d(x,"blur",D),d(y,"click",w)],I=!0)},p(e,i){t=e,2&i&&E!==(E=t[11]+"")&&m(n,E),2&i&&q!==(q=`<#Segment${t[13]}>`)&&m(h,q),2&i&&v!==(v="segment-tag\n\t\t\t\t "+(t[3].INITIALIZED===t[14]?"initialized":"")+"\n\t\t\t\t "+(t[3].MODIFIED===t[14]?"modified":"")+" svelte-1xmjlqq")&&p(s,"class",v),2&i&&$!==($=t[13])&&p(x,"data-segment-id",$),2&i&&g(x,t[12])},d(t){t&&a(e),t&&a(b),t&&a(x),t&&a(_),t&&a(y),I=!1,i(A)}}}function V(e){let n;function i(t,e){return t[0].length<1?J:P}let r=i(e),s=r(e);return{c(){n=c("main"),s.c()},m(t,e){u(t,n,e),s.m(n,null)},p(t,[e]){r===(r=i(t))&&s?s.p(t,e):(s.d(1),s=r(t),s&&(s.c(),s.m(n,null)))},i:t,o:t,d(t){t&&a(n),s.d()}}}const G=/^[\r\n\t\s]*/g,W=/[\r\n\t\s]*$/g;function H(t){const e=document.querySelector(`.line-editor[data-segment-id="${t}"]`);null!==e&&(e.focus(),e.setSelectionRange(0,-1))}function K(t,e,n){let i,r;const s={INITIALIZED:0,MODIFIED:2};let o="";function u(t){return t<i.length?t+1:t}return t.$$.update=()=>{1&t.$$.dirty&&n(1,i=F(o,{}).map((t=>{const e=t.match(G)[0]??"",n=t.match(W)[0]??"";if((t=t.trim()).lastIndexOf("\n")>-1){let i=t.split("\n").map((t=>t.trim())).filter((t=>t.length>0)).map((t=>({prefix:"",suffix:"\n",source:t})));return i[0].prefix=e,i[i.length-1].suffix=n,i}return[{prefix:e,suffix:n,source:t}]})).flat().map(((t,e)=>({...t,target:t.source,id:e+1,status:s.INITIALIZED})))),2&t.$$.dirty&&n(2,r=i.reduce(((t,e)=>(console.log(e),t+e.prefix+e.target.trim()+e.suffix)),""))},[o,i,r,s,function(t){if(t.ctrlKey){const e=parseInt(t.target.dataset.segmentId);"Enter"===t.key||"p"===t.key?H(function(t){return t>1?t-1:t}(e)):"n"===t.key?H(u(e)):"u"===t.key&&H(function(t){return i.filter((t=>t.status!==s.MODIFIED)).map((t=>t.id)).find((e=>e>t))??t}(e))}else if("Enter"===t.key){H(u(parseInt(t.target.dataset.segmentId)))}return!1},function(){o=this.value,n(0,o)},function(t,e){t[e].target=this.value,n(1,i),n(0,o)},(t,e,r)=>n(1,e[r].status=s.MODIFIED,i),(t,e,r,o,u)=>{n(1,r[o].target=e,i),n(1,r[o].status=s.INITIALIZED,i)}]}return new class extends class{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),C(this,t,K,V,s,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
